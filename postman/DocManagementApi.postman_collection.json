{
  "info": {
    "name": "Doc Management API",
    "_postman_id": "doc-management-api-collection",
    "description": "Collection for Doc Management API endpoints",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Ping",
      "item": [
        {
          "name": "Ping API",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/ping"
          }
        },
        {
          "name": "Ping API (with Authorization)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/ping",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" }
            ]
          }
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login as Admin",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/auth/login",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{adminEmail}}\",\n  \"password\": \"{{adminPassword}}\"\n}"
            }
          }
        },
        {
          "name": "Login as Comptable",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/auth/login",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{comptableEmail}}\",\n  \"password\": \"{{comptablePassword}}\"\n}"
            }
          }
        },
        {
          "name": "Login with Invalid Credentials",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/auth/login",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"wrong@example.com\",\n  \"password\": \"wrongpassword\"\n}"
            }
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/auth/logout",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Logout without token (should fail)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/auth/logout"
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get Current User Profile",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/users/me",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Update Current User Profile",
          "request": {
            "method": "PUT",
            "url": "{{baseUrl}}/users/me",
            "header": [
              { "key": "Authorization", "value": "Bearer {{userToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fullName\": \"Updated Name\",\n  \"email\": \"newemail@example.com\",\n  \"password\": \"newpassword123\"\n}"
            }
          }
        },
        {
          "name": "Create Comptable",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/users/comptable",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"comptable1@example.com\",\n  \"password\": \"password123\",\n  \"fullName\": \"Jean Dupont\"\n}"
            }
          }
        },
        {
          "name": "Get All Comptables",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/users/comptables",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Get All Users (with pagination)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/users?page=0&size=10&sortBy=createdAt",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Get User by ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/users/{{comptableId}}",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Update User Basic Info",
          "request": {
            "method": "PUT",
            "url": "{{baseUrl}}/users/{{comptableId}}",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fullName\": \"Jean-Pierre Dupont\",\n  \"email\": \"jp.dupont@example.com\"\n}"
            }
          }
        },
        {
          "name": "Admin Update - Change Active Status",
          "request": {
            "method": "PUT",
            "url": "{{baseUrl}}/users/{{comptableId}}/admin",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"active\": false\n}"
            }
          }
        },
        {
          "name": "Deactivate User",
          "request": {
            "method": "PATCH",
            "url": "{{baseUrl}}/users/{{comptableId}}/status",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"active\": false\n}"
            }
          }
        },
        {
          "name": "Delete User",
          "request": {
            "method": "DELETE",
            "url": "{{baseUrl}}/users/{{comptableId}}",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        }
      ]
    },
    {
      "name": "Documents",
      "item": [
        {
          "name": "Get All My Documents",
          "request": {
            "method": "GET",
            "url": "http://localhost:8080/api/documents",
            "header": [
              { "key": "Authorization", "value": "Bearer {{userToken}}" }
            ]
          }
        },
        {
          "name": "Upload Document",
          "request": {
            "method": "POST",
            "url": "http://localhost:8080/api/documents",
            "header": [
              { "key": "Authorization", "value": "Bearer {{userToken}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "" },
                { "key": "numeroPiece", "value": "DOC-001", "type": "text" },
                { "key": "typeDocument", "value": "FACTURE", "type": "text" },
                { "key": "categorieComptable", "value": "ACHAT", "type": "text" },
                { "key": "datePiece", "value": "2024-06-01", "type": "text" },
                { "key": "montant", "value": "1500.00", "type": "text" },
                { "key": "fournisseur", "value": "Fournisseur XYZ", "type": "text" },
                { "key": "exerciceComptable", "value": "2024", "type": "text" }
              ]
            }
          }
        },
        {
          "name": "Get Documents By Exercice",
          "request": {
            "method": "GET",
            "url": "http://localhost:8080/api/documents/exercice/2024",
            "header": [
              { "key": "Authorization", "value": "Bearer {{userToken}}" }
            ]
          }
        },
        {
          "name": "Get Document By ID",
          "request": {
            "method": "GET",
            "url": "http://localhost:8080/api/documents/1",
            "header": [
              { "key": "Authorization", "value": "Bearer {{userToken}}" }
            ]
          }
        },
        {
          "name": "Download Document By ID",
          "request": {
            "method": "GET",
            "url": "http://localhost:8080/api/documents/1/download",
            "header": [
              { "key": "Authorization", "value": "Bearer {{userToken}}" }
            ]
          }
        },
        {
          "name": "Comptable Validate Document (Approve)",
          "request": {
            "method": "POST",
            "url": "http://localhost:8080/api/v1/users/documents/1/validate",
            "header": [
              { "key": "Authorization", "value": "Bearer {{comptableToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"VALIDER\",\n  \"commentaire\": \"Document conforme\"\n}"
            }
          }
        },
        {
          "name": "Comptable Validate Document (Reject)",
          "request": {
            "method": "POST",
            "url": "http://localhost:8080/api/v1/users/documents/1/validate",
            "header": [
              { "key": "Authorization", "value": "Bearer {{comptableToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"REJETER\",\n  \"commentaire\": \"Erreur sur le montant\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Societes",
      "item": [
        {
          "name": "Create Societe",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/societes",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raisonSociale\": \"Entreprise ABC SARL\",\n  \"ice\": \"001234567890001\",\n  \"adresse\": \"123 Avenue Mohammed V, Casablanca\",\n  \"telephone\": \"+212 522 123456\",\n  \"emailContact\": \"contact@abc-sarl.ma\"\n}"
            }
          }
        },
        {
          "name": "Get All Societes",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/societes",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Get Societe by ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/societes/{{societeId}}",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Get Societe Compliance Overview",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/societes/{{societeId}}/compliance",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Assign Accountant to Societe",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/societes/{{societeId}}/accountant/3",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Update Accountant for Societe",
          "request": {
            "method": "PUT",
            "url": "{{baseUrl}}/societes/{{societeId}}/accountant/4",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Remove Accountant from Societe",
          "request": {
            "method": "DELETE",
            "url": "{{baseUrl}}/societes/{{societeId}}/accountant",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Get Societies by Accountant ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/societes/accountant/3",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        },
        {
          "name": "Update Societe",
          "request": {
            "method": "PUT",
            "url": "{{baseUrl}}/societes/{{societeId}}",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raisonSociale\": \"Entreprise ABC SARL - Updated\",\n  \"ice\": \"001234567890001\",\n  \"adresse\": \"123 Avenue Mohammed V, Nouvelle adresse, Casablanca\",\n  \"telephone\": \"+212 522 123457\",\n  \"emailContact\": \"new-contact@abc-sarl.ma\"\n}"
            }
          }
        },
        {
          "name": "Delete Societe",
          "request": {
            "method": "DELETE",
            "url": "{{baseUrl}}/societes/{{societeId}}",
            "header": [
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ]
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8080/api/v1" },
    { "key": "adminToken", "value": "" },
    { "key": "userToken", "value": "" },
    { "key": "comptableToken", "value": "" },
    { "key": "adminEmail", "value": "admin@gmail.com" },
    { "key": "adminPassword", "value": "password" },
    { "key": "comptableEmail", "value": "comptable@example.com" },
    { "key": "comptablePassword", "value": "password123" },
    { "key": "comptableId", "value": "" },
    { "key": "societeId", "value": "" }
  ]
}
